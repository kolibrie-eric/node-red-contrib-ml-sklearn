<script type="text/javascript">
	RED.nodes.registerType('random forest regressor', {
		category: 'machine learning',
		color: '#3499cd',
		defaults: {
			name: { value: "" },
			numTrees: { value: "" },
			maxDepth: { value: "" },
			indexColumn: { value: "" },
		},
		inputs: 1,
		outputs: 1,
		icon: "font-awesome/fa-line-chart",
		label: function () {
			return this.name || "random forest regressor";
		}
	});
</script>

<script type="text/x-red" data-template-name="random forest regressor">
	<div class="form-row">
		<label for="node-input-name"><i class="icon-tag"></i>Name</label>
		<input type="text" id="node-input-name" placeholder="Name">
	</div>
	<div class="form-row">
		<label for="node-input-numTrees"><i class="icon-tag"></i>Number of trees</label>
		<input type="number" id="node-input-numTrees" placeholder="10">
	</div>
	<div class="form-row">
		<label for="node-input-depth"><i class="icon-tag"></i>Depth</label>
		<input type="number" id="node-input-depth" placeholder="Max depth of the trees.">
	</div>
	<div class="form-row">
		<label for="node-input-indexColumn"><i class="icon-tag"></i>Index</label>
		<input type="text" id="node-input-indexColumn" placeholder="Name of the index column">
	</div>
</script>

<script type="text/x-red" data-help-name="random forest regressor">
	<p>A node that trains a Random Forest regressor model. The trained model is stored in a pickle file on disk in the node red user directory</p>

	<h3>Inputs</h3>
	<dl class="message-properties">
		<dt>payload
			<span class="property-type">table</span>
		</dt>
		<dd>The training dataset. The (desired) format is [{column1:value, column2: value, ...}{column1:value, column2: value, ...}]
			The last column is the y-variable. All the other columns will be treated as x-values
		</dd>

		<dt>name
			<span class="property-type">string</span>
		</dt>
		<dd>The name of the node</dd>

		<dt>index
			<span class="property-type">string</span>
		</dt>
		<dd>The column that will serve as the time index column. It will automatically be converted to a datetime, if specified</dd>
	</dl>

	<h3>Outputs</h3>
	<ol class="node-ports">
		<dl class="message-properties">
			<dt>payload <span class="property-type">string</span></dt>
			<dd>The full file name of the trained model. The file name is based on the node id to make it unique across all flows.</dd>
			<dt>topic <span class="property-type">string</span></dt>
			<dd>Upon success, set to the type of algorithm that was used to train the model</dd>
		</dl>
	</ol>

	<h3>Details</h3>
	<p>
		<code>msg.payload</code> is an array containing training cases with labels.
	</p>
	<p>
		This node fits a random forest regressor to such array in order to match the labels.
	</p>
</script>